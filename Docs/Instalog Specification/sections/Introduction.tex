\section{Introduction}
Instalog is a senior project by Jacob Snyder and Billy O'Neal, which is designed
to gather information from Microsoft Windows installations, for the purpose of
malware removal and system repair.  It must generate a human and machine
readable report which assists end users, remote experts, and local
administrators with issue diagnosis and malware removal.

Instalog is inspired by several similar tools which all share some basic
functionality.  In many ways, Instalog can be viewed as an evolution of
these tools:
\begin{itemize}
    \item TrendMicro's {\em Hijack This} (HJT)
    \item ``sUBs'' {\em Doesn't Do Squat} (DDS)
    \item ``random/random'''s {\em Random's System Information Tool} (RSIT)
    \item ``OldTimer'''s {\em OTA}, {\em OTS}, and {\em OTL} (formerly
    OTAnalyzeIt, OTScanIt, and OTListIt, respectively)
    \item Sysinternals' {\em Autoruns}
    \item Runscanner's {\em Runscanner}
\end{itemize}
all of which purport to accomplish similar goals to Instalog. However, each of
these tools has bugs or specific behavior which cause problems for at least one
of Instalog's three intended user groups.

Specifically, the above tools contain one or more of the above problems:
\begin{itemize}
    \item Incorrect handling and escaping of log data
    \item Lack of published specifications, documentation, or source code
    \item Outstanding bugs that the authors are unwilling or unable to fix
    \item Lack of scriptability, for the purposes of modifying log output and
    malware removal.
    \item Lack of 64 bit support.
    \item Lack of Unicode support.
    \item Lack of enumeration of some types of useful log information.
\end{itemize}
Instalog will attempt to solve those problems by combining characteristics of
the above tools which are deemed useful, while mixing in a few tricks of it's
own.

\subsection{Document Conventions}
Within the scope of this document, computer output or other information that is
to be taken literally is written in \texttt{fixed width text}. In some
instances, a block of fixed width text will be surrounded by non-fixed width
quotes ``\texttt{ like this}''. In such cases, the quotes are not significant,
and there will there will (typically) be leading or trailing space around the
fixed width block, which is significant and MUST NOT be removed. Variables,
which are replaced with some content, are written of the form \var{name}, and
will be explained in greater detail in prose surrounding a given block of
\texttt{fixed width} text.

Portions of this document are written in terms of the \verb|.REG| format
described by Regedit, a windows component. The syntax for the regedit script is
described in several locations, in particular  of \texttt{monospaced}
(\url{http://en.wikipedia.org/wiki/Windows_Registry#.REG_files}).

Additionally WOW64 (Windows on Windows 64) defines a system whereby registry
virtualization is in effect -- 32 bit programs are shown a virtualized view of
the 64 bit registry. Current versions of windows implement this by putting the
32 bit registry view in a key called ``\verb|Wow6432Node|'' in the root of each
hive in the registry. Additionally, Windows provides flags to the functions that open
registry keys, such as \verb|NtOpenKey| or \verb|RegCreateKeyEx|, which select
the correct view. Microsoft asks that applications be built in terms of the API
flags, because the specific name of \verb|Wow6432Node| is an implementation
detail which can change in future versions of Windows.

Therefore, we will define on top of the \verb|.REG| format a comment of
\verb|;32 Bit Registry View| or \verb|;64 Bit Registry View|, which represent
the flag that would be passed into Windows when opening the indicated key.

\subsection{Intended Audience}
Instalog is designed with three types of target users in mind. These ``user
classes'' are listed in the following sections.

\subsubsection{Home Users}
For a typical home user, Instalog must not display a complicated interface, and
must make it relatively difficult to misstep and take a wrong action. Few
options need be presented, such as the ability to generate a default report and
the ability to take a given script and run it on a target machine. Complicated
features such as analysis must not be displayed; though they may appear as
options that are, by default, deselected.

\subsubsection{Administrators}
Administrators are similar to home users in that they are physically working at
a computer being examined, but they are different in that they have the intent of
repairing their own computer or the computer of a client. They wish to see
analysis features and more possible options. Instalog must provide a means for
Administrators to use it's analysis features without manual saving and reloading
of log files.

\subsubsection{Forum Experts}
Forum Experts help typical end users repair their machines remotely over
self-help forums such as BleepingComputer.com or GeeksToGo.com.
These users work remotely, and likely will never see a given target
machine.
Instalog must produce log formats that are human readable in the vast majority
of cases, but which can be passed through common forum software such as Invision
Power Board, phpBB, or vBulletin without destruction of information.
Unfortunately, this makes common data exchange formats such as JSON and XML
unsuitable. 

Moreover, as obtaining additional information from a machine may
have lead times of several days, Instalog's report must be unambiguous; that is,
no two possible system configurations may produce the same output. Experts can
also benefit from log analysis features. Finally, Experts need to be able to
write simple, human readable scripts to perform actions to fix a user's machine
remotely.

\subsection{Acknowledgements}
Instalog's authors would like to thank ``sUBs'' for use of DDS's whitelisting
data for use in Instalog, and for being available for occasional clarification
of problems. He also allowed use of a modified form of DDS' logging format.

Instalog also was constructed with feedback taken from self help forums like
BleepingComputer, and students in Dr. Glutekin Ozsoyoglu's EECS 395: Senior
Project class of Spring 2012, at Case Western Reserve University.

\subsection{Licensing} \label{sec:licensing}
Instalog itself is to be released under the two clause form of the BSD license,
which is reprinted below:

\begin{verbatim}
Copyright Â© 2012, Jacob Snyder, Billy O'Neal III, and "sUBs"
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met: 

1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer. 
2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution. 

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
\end{verbatim}

This document, along with all other documentation related to Instalog,  is to be
released under the Creative Commons Attribution 3.0 Unported license. Human
readable and lawyer readable versions of this license can be found at
\url{http://creativecommons.org/licenses/by/3.0/}.

\subsection{Minimum System Requirements}
Instalog MUST run on all Microsoft Windows NT variants released later than
Windows 2000 SP4:
\begin{itemize}
  \item Windows 2000 (x86, SP4 only)
  \item Windows XP (x86 and x64, RTM, SP1, SP2, and SP3)
  \item Windows Vista (x86 and x64, RTM, SP1, and SP2)
  \item Windows 7 (x86 and x64, RTM and SP1)
  \item Windows Server 2003 (x86 and x64, RTM, SP1, and SP2)
  \item Windows Server 2003 R2 (x86 and x64, RTM, SP1, and SP2)
  \item Windows Server 2008 (x86 and x64, RTM, SP1, and SP2)
  \item Windows Server 2008 R2 (x64, RTM, and SP1)
\end{itemize}

No attempt will be made to support Itanium architecture systems as Instalog's
authors do not have access to suitable testing hardware. No attempt will be made
to support MS-DOS based versions of Windows. Instalog's behavior on unsupported
machines must not cause data destruction, but is otherwise undefined.

\subsection{Scope Limit}
While the authors would like to complete this entire tool before the completion
of the Senior Project class in April, they realize that this may not be possible
given the scale of the tool. Therefore, if they must cut features to meet the
deadline, these features shall be cut, in order (lower number on this list
means more likely to be cut):
\begin{enumerate}
    \item Checkboxes and fix generation on the GUI
    \item ``Value Added'' scripting actions, such as MRC upload or VirusTotal
    upload
    \item Spoofed DNS check
    \item Enumeration of Google Chrome data
    \item Enumeration of Firefox data
    \item GUI altogether
    \item Scripting altogether
\end{enumerate}

In the event any of these features are removed, Instalog must remain a
functional, shippable, well tested, production-quality product, suitable for the
author's Senior Project submission.